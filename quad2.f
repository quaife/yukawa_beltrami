      subroutine quad2(v,u,num_pts,a,order,n)
c     These quadrature rules correspond to the formulas found in Alpert's papers
c     for functions of the form phi(x)*log(x)+psi(x).
c     v are the sample points, u are the weights, a is the necessary shift for the
c     second term and n tells the subroutine which quadrature rule to use

      implicit real*8 (a-h,o-z)
      real*8 v(16),u(16)
      integer a,order

      if (n.eq.1) then
         num_pts=1
         v(1)=1.591549430918953d-1
         
         u(1)=5.0d-1
	 a=1
         order=2
c        minimum value of a is 1, order of convergence is h^2*log(h)
      endif

      if (n.eq.2) then
         num_pts=2
         v(1)=1.150395811972836d-1
         v(2)=9.365464527949632d-1

         u(1)=3.913373788753340d-1
         u(2)=1.108662621124666d0
	 a=2
	 order=3
c        minimum value of a is 2, order of convergence is h^3*log(h)
      endif

      if (n.eq.3) then
         num_pts=3
         v(1)=2.379647284118974d-2
         v(2)=2.935370741501914d-1
         v(3)=1.023715124251890d0

         u(1)=8.795942675593887d-2
         u(2)=4.989017152913699d-1
         u(3)=9.131388579526912d-1
	 a=2
	 order=4
c        minimum value of a is 2, order of convergence is h^4*log(h)
      endif

      if (n.eq.4) then
         num_pts=4
         v(1)=2.339013027203800d-2
         v(2)=2.854764931311984d-1
         v(3)=1.005403327220700d0
         v(4)=1.994970303994294d0

         u(1)=8.609736556158105d-2
         u(2)=4.847019685417959d-1
         u(3)=9.152988869123725d-1
         u(4)=1.013901778984250d0
         a=3
  	 order=5
c        minimum value of a is 3, order of convergence is h^5*log(h)
      endif

      if (n.eq.5) then
         num_pts=5
         v(1)=4.004884194926570d-3
         v(2)=7.745655373336686d-2
         v(3)=3.972849993523248d-1
         v(4)=1.075673352915104d0
         v(5)=2.003796927111872d0

         u(1)=1.671879691147102d-2
         u(2)=1.636958371447360d-1
         u(3)=4.981856569770637d-1
         u(4)=8.372266245578912d-1
         u(5)=9.841730844088381d-1
         a=3
	 order=6
c        minimum value of a is 3, order of convergence is h^6*log(h)
      endif

      if (n.eq.6) then
         num_pts=7
         v(1)=6.531815708567918d-3
         v(2)=9.086744584657729d-2
         v(3)=3.967966533375878d-1
         v(4)=1.027856640525646d0
         v(5)=1.945288592909266d0
         v(6)=2.980147933889640d0
         v(7)=3.998861349951123d0

         u(1)=2.462194198995203d-2
         u(2)=1.701315866854178d-1
         u(3)=4.609256358650077d-1
         u(4)=7.947291148621894d-1
         u(5)=1.008710414337933d0
         u(6)=1.036093649726216d0
         u(7)=1.004787656533285d0
         a=5
	 order=8
c        minimum value of a is 5, order of convergence is h^8*log(h)
      endif

      if (n.eq.7) then
         num_pts=10
         v(1)=1.175089381227308d-3
         v(2)=1.877034129831289d-2
         v(3)=9.686468391426860d-2
         v(4)=3.004818668002884d-1
         v(5)=6.901331557173356d-1
         v(6)=1.293695738083659d0
         v(7)=2.090187729798780d0
         v(8)=3.016719313149212d0
         v(9)=4.001369747872486d0
         v(10)=5.000025661793423d0

         u(1)=4.560746882084207d-3
         u(2)=3.810606322384757d-2
         u(3)=1.293864997289512d-1
         u(4)=2.884360381408835d-1
         u(5)=4.958111914344961d-1
         u(6)=7.077154600594529d-1
         u(7)=8.741924365285083d-1
         u(8)=9.661361986515218d-1
         u(9)=9.957887866078700d-1
         u(10)=9.998665787423845d-1
         a=6
	 order=10
c        minimum value of a is 6, order of convergence is h^10*log(h)
      endif

      if (n.eq.8) then
         num_pts=11
         v(1)=1.674223682668368d-3
         v(2)=2.441110095009738d-2
         v(3)=1.153851297429517d-1
         v(4)=3.345898490480388d-1
         v(5)=7.329740531807683d-1
         v(6)=1.332305048525433d0
         v(7)=2.114358752325948d0
         v(8)=3.026084549655318d0
         v(9)=4.003166301292590d0
         v(10)=5.000141170055870d0
         v(11)=6.000001002441859d0

         u(1)=6.364190780720557d-3
         u(2)=4.723964143287529d-2
         u(3)=1.450891158385963d-1
         u(4)=3.021659470785897d-1
         u(5)=4.984270739715340d-1
         u(6)=6.971213795176096d-1
         u(7)=8.577295622757315d-1
         u(8)=9.544136554351155d-1
         u(9)=9.919938052776484d-1
         u(10)=9.994621875822987d-1
         u(11)=9.999934408092805d-1
         a=7
	 order=12
c        minimum value of a is 7, order of convergence is h^12*log(h)
      endif
      
      if (n.eq.9) then
         num_pts=14
         v(1)=9.305182368545380d-4
         v(2)=1.373832458434617d-2
         v(3)=6.630752760779359d-2
         v(4)=1.979971397622003d-1
         v(5)=4.504313503816532d-1
         v(6)=8.571888631101634d-1
         v(7)=1.434505229617112d0
         v(8)=2.175177834137754d0
         v(9)=3.047955068386372d0
         v(10)=4.004974906813428d0
         v(11)=4.998525901820967d0
         v(12)=5.999523015116678d0
         v(13)=6.999963617883990d0
         v(14)=7.999999488130134d0

         u(1)=3.545060644780164d-3
         u(2)=2.681514031576498d-2
         u(3)=8.504092035093420d-2
         u(4)=1.854526216643691d-1
         u(5)=3.251724374883192d-1
         u(6)=4.911553747260108d-1
         u(7)=6.622933417369036d-1
         u(8)=8.137254578840510d-1
         u(9)=9.235595514944174d-1
         u(10)=9.821609923744658d-1
         u(11)=1.000047394596121d0
         u(12)=1.000909336693954d0
         u(13)=1.000119534283784d0
         u(14)=1.000002835746089d0
         a=9
         order=14
c        minimum value of a is 9, order of convergence is h^14*log(h)
      endif

      if (n.eq.10) then
         num_pts=15
         v(1)=8.371529832014113d-4
         v(2)=1.239382725542637d-2
         v(3)=6.009290785739468d-2
         v(4)=1.805991249601928d-1
         v(5)=4.142832599028031d-1
         v(6)=7.964747731112430d-1
         v(7)=1.348993882467059d0
         v(8)=2.073471660264395d0
         v(9)=2.947904939031494d0
         v(10)=3.928129252248612d0
         v(11)=4.957203086563112d0
         v(12)=5.986360113977494d0
         v(13)=6.997957704791519d0
         v(14)=7.999888757524622d0
         v(15)=8.999998754306120d0

         u(1)=3.190919086626234d-3
         u(2)=2.423621380426338d-2
         u(3)=7.740135521653088d-2
         u(4)=1.704889420286369d-1
         u(5)=3.029123478511309d-1
         u(6)=4.652220834914617d-1
         u(7)=6.401489637096768d-1
         u(8)=8.051212946181061d-1
         u(9)=9.362411945698647d-1
         u(10)=1.014359775369075d0
         u(11)=1.035167721053657d0
         u(12)=1.020308624984610d0
         u(13)=1.004798397441514d0
         u(14)=1.000395017352309d0
         u(15)=1.000007149422537d0
         a=10
         order=16
c        minimum value of a is 9, order of convergence is h^16*log(h)
      endif

      return
      end
